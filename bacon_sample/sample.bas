0 '----------------------------------------
1 ' SAMPLE PROGRAM FOR MSX-BACON
2 ' COPYRIGHT 2023 CHIKUWA TEIKOKU
3 '----------------------------------------

10 SCREEN 1,2,0:COLOR 15,1,1:WIDTH 32:KEYOFF
20 DEFINT A-Z
30 DEFUSR0=&H007E:A=USR0(0) 'SETGRP
40 DIM B1(128),B2(128),B3(128),B4(128)
50 DIM C1(128),C2(128),C3(128),C4(128)
60 FL=0:TM=0:ST=0:TG=0
70 ON INTERVAL=1 GOSUB 7500 'VSYNC

100 'PREPARE
110 LOCATE 0,0:PRINT "NOW LOADING..."
120 GOSUB 1500 'INIT PCG
130 GOSUB 1000 'INIT PARAMS
140 GOSUB 7000 'INIT PSG
150 GOSUB 2000 'DEFINE SPRITE
160 GOSUB 3000 'DEFINE PCG
170 GOSUB 8000 'SET BGM
180 CLS:GOSUB 6000 'DRAW STAGE
190 INTERVAL ON

300 'MAIN LOOP
310 GOSUB 4000 'DRAW PLAYER
320 ST=STICK(0):IF ST=0 THEN ST=STICK(1)
330 IF ST<>0 THEN GOSUB 5000 'MOVE PLAYER
340 GOSUB 9200 'DEPLOY OR MOVE & DRAW CHIKUWA
350 GOTO 300

1000 'INIT PARAMS
1010 PX=120:PY=160:MX=PX:MY=PY:MV=8:CD=0:PP=0:AC=0
1020 CW=2:CH=2:CS=&H60:DIM CX(8):DIM CY(8):DIM CE(8)
1030 FOR I=0 TO 7:CX(I)=0:CY(I)=0:CE(I)=0:NEXT I
1040 RETURN

1500 'INIT PCG
1510 FA=PEEK(&H1BBF)
1520 FOR I=32 TO 95
1530  FOR J=0 TO 7
1540   VPOKE &H0000+I*8+J, VPEEK(FA+I*8+J)
1550   VPOKE &H0800+I*8+J, VPEEK(FA+I*8+J)
1560   VPOKE &H1000+I*8+J, VPEEK(FA+I*8+J)
1570   VPOKE &H2000+I*8+J, &HF1
1580   VPOKE &H2800+I*8+J, &HF1
1590   VPOKE &H3000+I*8+J, &HF1
1600  NEXT J
1610 NEXT I
1620 RETURN

2000 'DEFINE SPRITE
2010 RESTORE 10000
2020 FOR I=0 TO 1
2030  L$="":R$=""
2040  FOR J=0 TO 15
2050   READ SP$
2060   L$=L$+CHR$(VAL("&B"+LEFT$(SP$,8)))
2070   R$=R$+CHR$(VAL("&B"+RIGHT$(SP$,8)))
2080  NEXT J
2090  SPRITE$(I)=L$+R$
2100  NEXT I
2110 RETURN

3000 'DEFINE PCG
3010 RESTORE 15000
3020 FOR I=0 TO 5
3030  FOR J=0 TO 7
3040   READ CP$:READ CL$
3050   VPOKE &H0000+(&H60+I)*8+J,VAL("&B"+CP$)
3060   VPOKE &H0800+(&H60+I)*8+J,VAL("&B"+CP$)
3070   VPOKE &H1000+(&H60+I)*8+J,VAL("&B"+CP$)
3080   VPOKE &H2000+(&H60+I)*8+J,VAL("&H"+CL$)
3090   VPOKE &H2800+(&H60+I)*8+J,VAL("&H"+CL$)
3100   VPOKE &H3000+(&H60+I)*8+J,VAL("&H"+CL$)
3110  NEXT J
3120 NEXT I
3130 RETURN

4000 'DRAW PLAYER
4010 PUTSPRITE 0,(PX,PY),13,PP
4020 AC=AC+1:IF AC>0 THEN AC=0:PP=1-PP
4030 RETURN

5000 'MOVE PLAYER
5010 'IF ST=1 THEN MY=MY-MV
5020 IF ST=3 THEN MX=MX+MV
5030 'IF ST=5 THEN MY=MY+MV
5040 IF ST=7 THEN MX=MX-MV
5050 GOSUB 5500 'COLISION DETECT
5060 IF CD=1 THEN MX=PX:MY=PY
5070 PX=MX:PY=MY
5080 RETURN

5500 'COLISION DETECT
5510 CD=0
5520 IF MX<0 THEN CD=1:RETURN
5530 IF MX>256-16 THEN CD=1:RETURN
5540 'IF MY<0 THEN CD=1:RETURN
5550 'IF MY>192-16 THEN CD=1:RETURN
5560 RETURN

6000 'DRAW STAGE
6010 RESTORE 30000
6020 FOR I=0 TO 23
6030  READ BG$
6040  FOR J=0 TO 31
6050   VPOKE &H1800+I*32+J,ASC(MID$(BG$,J+1,1))
6060  NEXT J
6070 NEXT I
6080 RETURN

7000 'INIT PSG
7010 SOUND 7,&HB8
7020 SOUND 8,0
7030 SOUND 9,0
7040 SOUND 10,0
7050 SOUND 11,&H00
7060 SOUND 12,&H00
7070 SOUND 13,&H08
7080 AC=0:AI=0
7090 BC=0:BI=0
7100 CC=0:CI=0
7110 HP=0
7120 RETURN

7500 'VSYNC
7510 GOSUB 7600 'PLAY BGM
7520 FL=FL+1:IF FL>59 THEN FL=0
7530 RETURN

7600 'PLAY BGM
7610 IF (FL MOD TM)>0 THEN RETURN
7620 IF BI>=BC GOTO 7690
7630 SOUND 9,B1(BI)
7640 SOUND 6,B2(BI)
7650 SOUND 2,B3(BI)
7660 SOUND 3,B4(BI)
7670 BI=BI+1
7680 IF BI>=BC THEN BI=0
7690 IF CI>=CC GOTO 7760
7700 SOUND10,C1(CI)
7710 SOUND 6,C2(CI)
7720 SOUND 4,C3(CI)
7730 SOUND 5,C4(CI)
7740 CI=CI+1
7750 IF CI>=CC THEN CI=0
7760 RETURN

8000 'SET BGM
8010 RESTORE 20000
8020 FOR I=0 TO 127
8030  READ B1$:READ B2$:READ B3$:READ B4$
8040  B1(I)=VAL(B1$):B2(I)=VAL(B2$):B3(I)=VAL(B3$):B4(I)=VAL(B4$)
8050 NEXT I
8060 BC=128:BI=0
8070 RESTORE 22000
8080 FOR I=0 TO 127
8090  READ C1$:READ C2$:READ C3$:READ C4$
8100  C1(I)=VAL(C1$):C2(I)=VAL(C2$):C3(I)=VAL(C3$):C4(I)=VAL(C4$)
8110 NEXT I
8120 CC=128:CI=0
8130 TM=3
8140 RETURN

9200 'DEPLOY OR MOVE & DRAW CHIKUWA
9210 FOR I=0 TO 7
9220  IF CE(I)=1 THEN GOTO 9260
9230  IF RND(1)*10>1 THEN GOTO 9420
9240  CX(I)=RND(1)*31:CY(I)=3:CE(I)=1
9250  GOTO 9330
9260  CY(I)=CY(I)+1:IF CY(I)<21 THEN 9330
9270  VPOKE &H1800+(20)*32+CX(I)+0,&H20
9280  VPOKE &H1800+(20)*32+CX(I)+1,&H20
9290  VPOKE &H1800+(21)*32+CX(I)+0,&H20
9300  VPOKE &H1800+(21)*32+CX(I)+1,&H20
9310  CX(I)=0:CY(I)=0:CE(I)=0
9320  GOTO 9420
9330  J=0
9340  VPOKE &H1800+(CY(I)-1)*32+CX(I)+0,&H20
9350  VPOKE &H1800+(CY(I)-1)*32+CX(I)+1,&H20
9360  FOR Y=0 TO CH-1
9370   FOR X=0 TO CW-1
9380    VPOKE &H1800+(CY(I)+Y)*32+CX(I)+X,CS+J
9390    J=J+1
9400   NEXT X
9410  NEXT Y
9420 NEXT I
9430 RETURN

10000 'SPRITE PATTERN
10010 '(0) MOMOMARU-1
10020 DATA 0000111001110000
10030 DATA 0001111111111000
10040 DATA 0011111111111100
10050 DATA 0111000110001110
10060 DATA 0111000110001110
10070 DATA 0111000110001110
10080 DATA 0111111111111110
10090 DATA 0110111111110110
10100 DATA 0111000000001110
10110 DATA 0011111111111100
10120 DATA 0000111111110000
10130 DATA 0111110110111110
10140 DATA 0000111111110000
10150 DATA 0011111001110000
10160 DATA 0000000011111100
10170 DATA 0000000000000000
10180 '(1) MOMOMARU-2
10190 DATA 0000111001110000
10200 DATA 0001111111111000
10210 DATA 0011111111111100
10220 DATA 0111111110001110
10230 DATA 0111000110001110
10240 DATA 0111111110001110
10250 DATA 0111111111111110
10260 DATA 0110000000000110
10270 DATA 0111000000001110
10280 DATA 0011100000011100
10290 DATA 0000111111110000
10300 DATA 0111110110111110
10310 DATA 0000111111110000
10320 DATA 0000111001111100
10330 DATA 0011111100000000
10340 DATA 0000000000000000

15000 'PCG PATTERN
15010 '&H60(`) ちくわの左上
15020 DATA 00000000, F1
15030 DATA 00000000, F1
15040 DATA 00000000, F1
15050 DATA 00000000, F1
15060 DATA 00000001, A1
15070 DATA 00000011, A1
15080 DATA 00000111, A1
15090 DATA 00001111, A1
15100 '&H61(a) ちくわの右上
15110 DATA 00000000, F1
15120 DATA 00111100, F1
15130 DATA 01111110, F1
15140 DATA 11010110, F1
15150 DATA 10101110, A1
15160 DATA 11111110, A1
15170 DATA 11111100, A1
15180 DATA 11111000, A1
15190 '&H62(b) ちくわの左下
15200 DATA 00011110, A1
15210 DATA 00111101, A1
15220 DATA 01111110, F1
15230 DATA 01001101, F1
15240 DATA 01000111, F1
15250 DATA 01100110, F1
15260 DATA 00111100, F1
15270 DATA 00000000, F1
15280 '&H63(c) ちくわの右下
15290 DATA 10110000, A1
15300 DATA 01100000, A1
15310 DATA 11000000, F1
15320 DATA 10000000, F1
15330 DATA 00000000, F1
15340 DATA 00000000, F1
15350 DATA 00000000, F1
15360 DATA 00000000, F1
15370 '&H64(d) 地面上
15380 DATA 11111111, 26
15390 DATA 11111111, 26
15400 DATA 11111111, 26
15410 DATA 11111111, 26
15420 DATA 10101010, 26
15430 DATA 01010101, 26
15440 DATA 10101010, 26
15450 DATA 01010101, 26
15460 '&H65(e) 地面下
15470 DATA 10101010, 61
15480 DATA 01010101, 61
15490 DATA 10101010, 61
15500 DATA 01010101, 61
15510 DATA 10101010, 61
15520 DATA 01010101, 61
15530 DATA 10101010, 61
15540 DATA 01010101, 61

20000 'BGM DATA (1-1) ちくわ帝国の国家(メロディー)
20010 DATA 11,0,&HAA,&H00
20020 DATA 11,0,&HAA,&H00
20030 DATA 11,0,&HAA,&H00
20040 DATA 11,0,&H7F,&H00
20050 DATA 11,0,&H87,&H00
20060 DATA  0,0,&H00,&H00
20070 DATA 11,0,&H97,&H00
20080 DATA  0,0,&H00,&H00
20090 DATA 11,0,&HAA,&H00
20100 DATA 11,0,&HAA,&H00
20110 DATA 11,0,&HAA,&H00
20120 DATA 11,0,&HBE,&H00
20130 DATA 11,0,&HCA,&H00
20140 DATA  0,0,&H00,&H00
20150 DATA 11,0,&HBE,&H00
20160 DATA  0,0,&H00,&H00
20170 DATA 11,0,&HAA,&H00
20180 DATA 11,0,&HAA,&H00
20190 DATA 11,0,&HAA,&H00
20200 DATA 11,0,&H97,&H00
20210 DATA 11,0,&HAA,&H00
20220 DATA  0,0,&H00,&H00
20230 DATA 11,0,&H97,&H00
20240 DATA  0,0,&H00,&H00
20250 DATA 11,0,&HAA,&H00
20260 DATA 11,0,&HAA,&H00
20270 DATA 11,0,&HAA,&H00
20280 DATA 11,0,&HAA,&H00
20290 DATA  0,0,&H00,&H00
20300 DATA  0,0,&H00,&H00
20310 DATA  0,0,&H00,&H00
20320 DATA  0,0,&H00,&H00
20330 DATA 11,0,&HAA,&H00
20340 DATA 11,0,&HAA,&H00
20350 DATA 11,0,&HAA,&H00
20360 DATA 11,0,&H7F,&H00
20370 DATA 11,0,&H87,&H00
20380 DATA  0,0,&H00,&H00
20390 DATA 11,0,&H7F,&H00
20400 DATA  0,0,&H00,&H00
20410 DATA 11,0,&H71,&H00
20420 DATA 11,0,&H71,&H00
20430 DATA 11,0,&H71,&H00
20440 DATA 11,0,&H97,&H00
20450 DATA 11,0,&H87,&H00
20460 DATA  0,0,&H00,&H00
20470 DATA 11,0,&H7F,&H00
20480 DATA  0,0,&H00,&H00
20490 DATA 11,0,&H71,&H00
20500 DATA 11,0,&H71,&H00
20510 DATA 11,0,&H71,&H00
20520 DATA 11,0,&H65,&H00
20530 DATA 11,0,&H71,&H00
20540 DATA  0,0,&H00,&H00
20550 DATA 11,0,&H65,&H00
20560 DATA  0,0,&H00,&H00
20570 DATA 11,0,&H71,&H00
20580 DATA 11,0,&H71,&H00
20590 DATA 11,0,&H71,&H00
20600 DATA 11,0,&H71,&H00
20610 DATA  0,0,&H00,&H00
20620 DATA  0,0,&H00,&H00
20630 DATA  0,0,&H00,&H00
20640 DATA  0,0,&H00,&H00
20650 DATA 11,0,&H65,&H00
20660 DATA 11,0,&H65,&H00
20670 DATA 11,0,&H65,&H00
20680 DATA 11,0,&H97,&H00
20690 DATA 11,0,&H7F,&H00
20700 DATA  0,0,&H00,&H00
20710 DATA 11,0,&H65,&H00
20720 DATA  0,0,&H00,&H00
20730 DATA 11,0,&H5F,&H00
20740 DATA 11,0,&H5F,&H00
20750 DATA 11,0,&H5F,&H00
20760 DATA 11,0,&H5F,&H00
20770 DATA 11,0,&H65,&H00
20780 DATA 11,0,&H65,&H00
20790 DATA 11,0,&H65,&H00
20800 DATA 11,0,&H65,&H00
20810 DATA 11,0,&H71,&H00
20820 DATA 11,0,&H71,&H00
20830 DATA 11,0,&H71,&H00
20840 DATA 11,0,&H65,&H00
20850 DATA 11,0,&H71,&H00
20860 DATA  0,0,&H00,&H00
20870 DATA 11,0,&H97,&H00
20880 DATA  0,0,&H00,&H00
20890 DATA 11,0,&H71,&H00
20900 DATA 11,0,&H71,&H00
20910 DATA 11,0,&H71,&H00
20920 DATA 11,0,&H71,&H00
20930 DATA  0,0,&H00,&H00
20940 DATA  0,0,&H00,&H00
20950 DATA  0,0,&H00,&H00
20960 DATA  0,0,&H00,&H00
20970 DATA 11,0,&H97,&H00
20980 DATA 11,0,&H97,&H00
20990 DATA 11,0,&H97,&H00
21000 DATA 11,0,&HA0,&H00
21010 DATA 11,0,&H97,&H00
21020 DATA  0,0,&H00,&H00
21030 DATA 11,0,&H8F,&H00
21040 DATA  0,0,&H00,&H00
21050 DATA 11,0,&H87,&H00
21060 DATA 11,0,&H87,&H00
21070 DATA 11,0,&H87,&H00
21080 DATA 11,0,&H8F,&H00
21090 DATA 11,0,&H87,&H00
21100 DATA  0,0,&H00,&H00
21110 DATA 11,0,&H7F,&H00
21120 DATA  0,0,&H00,&H00
21130 DATA 11,0,&H71,&H00
21140 DATA 11,0,&H71,&H00
21150 DATA 11,0,&H71,&H00
21160 DATA 11,0,&H97,&H00
21170 DATA 11,0,&H87,&H00
21180 DATA  0,0,&H00,&H00
21190 DATA 11,0,&H7F,&H00
21200 DATA  0,0,&H00,&H00
21210 DATA 11,0,&H71,&H00
21220 DATA 11,0,&H71,&H00
21230 DATA 11,0,&H71,&H00
21240 DATA 11,0,&H71,&H00
21250 DATA 11,0,&HAA,&H00
21260 DATA 11,0,&HAA,&H00
21270 DATA 11,0,&HAA,&H00
21280 DATA  0,0,&H00,&H00

22000 'BGM DATA (1-2) ちくわ帝国の国家(ベース)
22010 DATA 11,0,&HA7,&H02
22020 DATA  0,0,&H00,&H00
22030 DATA 11,0,&HA7,&H02
22040 DATA  0,0,&H00,&H00
22050 DATA  0,0,&H00,&H00
22060 DATA  0,0,&H00,&H00
22070 DATA 11,0,&HA7,&H02
22080 DATA  0,0,&H00,&H00
22090 DATA 11,0,&HA7,&H02
22100 DATA  0,0,&H00,&H00
22110 DATA 11,0,&HA7,&H02
22120 DATA  0,0,&H00,&H00
22130 DATA  0,0,&H00,&H00
22140 DATA  0,0,&H00,&H00
22150 DATA 11,0,&HA7,&H02
22160 DATA  0,0,&H00,&H00
22170 DATA 11,0,&HA7,&H02
22180 DATA  0,0,&H00,&H00
22190 DATA 11,0,&HA7,&H02
22200 DATA  0,0,&H00,&H00
22210 DATA  0,0,&H00,&H00
22220 DATA  0,0,&H00,&H00
22230 DATA 11,0,&HA7,&H02
22240 DATA  0,0,&H00,&H00
22250 DATA 11,0,&HA7,&H02
22260 DATA  0,0,&H00,&H00
22270 DATA 11,0,&HA7,&H02
22280 DATA  0,0,&H00,&H00
22290 DATA  0,0,&H00,&H00
22300 DATA  0,0,&H00,&H00
22310 DATA 11,0,&HA7,&H02
22320 DATA  0,0,&H00,&H00
22330 DATA 11,0,&HA7,&H02
22340 DATA  0,0,&H00,&H00
22350 DATA 11,0,&HA7,&H02
22360 DATA  0,0,&H00,&H00
22370 DATA  0,0,&H00,&H00
22380 DATA  0,0,&H00,&H00
22390 DATA 11,0,&HA7,&H02
22400 DATA  0,0,&H00,&H00
22410 DATA 11,0,&HA7,&H02
22420 DATA  0,0,&H00,&H00
22430 DATA 11,0,&HA7,&H02
22440 DATA  0,0,&H00,&H00
22450 DATA  0,0,&H00,&H00
22460 DATA  0,0,&H00,&H00
22470 DATA 11,0,&HA7,&H02
22480 DATA  0,0,&H00,&H00
22490 DATA 11,0,&HC5,&H01
22500 DATA  0,0,&H00,&H00
22510 DATA 11,0,&HC5,&H01
22520 DATA  0,0,&H00,&H00
22530 DATA  0,0,&H00,&H00
22540 DATA  0,0,&H00,&H00
22550 DATA 11,0,&HC5,&H01
22560 DATA  0,0,&H00,&H00
22570 DATA 11,0,&HC5,&H01
22580 DATA  0,0,&H00,&H00
22590 DATA 11,0,&HC5,&H01
22600 DATA  0,0,&H00,&H00
22610 DATA  0,0,&H00,&H00
22620 DATA  0,0,&H00,&H00
22630 DATA 11,0,&HC5,&H01
22640 DATA  0,0,&H00,&H00
22650 DATA 11,0,&H94,&H01
22660 DATA  0,0,&H00,&H00
22670 DATA 11,0,&H94,&H01
22680 DATA  0,0,&H00,&H00
22690 DATA  0,0,&H00,&H00
22700 DATA  0,0,&H00,&H00
22710 DATA 11,0,&H94,&H01
22720 DATA  0,0,&H00,&H00
22730 DATA 11,0,&H94,&H01
22740 DATA  0,0,&H00,&H00
22750 DATA 11,0,&H94,&H01
22760 DATA  0,0,&H00,&H00
22770 DATA  0,0,&H00,&H00
22780 DATA  0,0,&H00,&H00
22790 DATA 11,0,&H94,&H01
22800 DATA  0,0,&H00,&H00
22810 DATA 11,0,&HC5,&H01
22820 DATA  0,0,&H00,&H00
22830 DATA 11,0,&HC5,&H01
22840 DATA  0,0,&H00,&H00
22850 DATA  0,0,&H00,&H00
22860 DATA  0,0,&H00,&H00
22870 DATA 11,0,&HC5,&H01
22880 DATA  0,0,&H00,&H00
22890 DATA 11,0,&HC5,&H01
22900 DATA  0,0,&H00,&H00
22910 DATA 11,0,&HC5,&H01
22920 DATA  0,0,&H00,&H00
22930 DATA  0,0,&H00,&H00
22940 DATA  0,0,&H00,&H00
22950 DATA 11,0,&HC5,&H01
22960 DATA  0,0,&H00,&H00
22970 DATA 11,0,&H3B,&H02
22980 DATA  0,0,&H00,&H00
22990 DATA 11,0,&H3B,&H02
23000 DATA  0,0,&H00,&H00
23010 DATA  0,0,&H00,&H00
23020 DATA  0,0,&H00,&H00
23030 DATA 11,0,&H3B,&H02
23040 DATA  0,0,&H00,&H00
23050 DATA 11,0,&H1B,&H02
23060 DATA  0,0,&H00,&H00
23070 DATA 11,0,&H1B,&H02
23080 DATA  0,0,&H00,&H00
23090 DATA  0,0,&H00,&H00
23100 DATA  0,0,&H00,&H00
23110 DATA 11,0,&H1B,&H02
23120 DATA  0,0,&H00,&H00
23130 DATA  0,0,&H00,&H00
23140 DATA  0,0,&H00,&H00
23150 DATA 11,0,&HC5,&H01
23160 DATA  0,0,&H00,&H00
23170 DATA 11,0,&HC5,&H01
23180 DATA  0,0,&H00,&H00
23190 DATA 11,0,&HC5,&H01
23200 DATA  0,0,&H00,&H00
23210 DATA 11,0,&HC5,&H01
23220 DATA  0,0,&H00,&H00
23230 DATA  0,0,&H00,&H00
23240 DATA  0,0,&H00,&H00
23250 DATA 11,0,&HA7,&H02
23260 DATA  0,0,&H00,&H00
23270 DATA  0,0,&H00,&H00
23280 DATA  0,0,&H00,&H00

30000 'BG DATA
30010 DATA "`a`a`a  MSX-BACON SAMPLE  `a`a`a"
30020 DATA "bcbcbc                    bcbcbc"
30030 DATA "                                "
30040 DATA "                                "
30050 DATA "                                "
30060 DATA "                                "
30070 DATA "                                "
30080 DATA "                                "
30090 DATA "                                "
30100 DATA "                                "
30110 DATA "                                "
30120 DATA "                                "
30130 DATA "                                "
30140 DATA "                                "
30150 DATA "                                "
30160 DATA "                                "
30170 DATA "                                "
30180 DATA "                                "
30190 DATA "                                "
30200 DATA "                                "
30210 DATA "                                "
30220 DATA "                                "
30230 DATA "dddddddddddddddddddddddddddddddd"
30240 DATA "eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee"
